<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carta Restaurante Pepito</title>
<link rel="stylesheet" href="css/styles.css">
</head>
<body>

<div class="container">
  <header>
    <h1>Restaurante Pepito</h1>
    <p>Carta digital üçΩÔ∏è</p>
  </header>

  <main>
    <section class="menu-section" id="menuDisplay">
      <button class="collapsible">Carta</button>
      <div class="content"><ul></ul></div>
    </section>
  </main>

  <footer>
    <p>¬© 2026 Restaurante Pepito</p>
  </footer>
</div>

<script type="module">
import { supabase, getMenu } from './js/supabase.js'

const cartaUl = document.querySelector("#menuDisplay ul")

async function cargarCarta() {
  // Carga todos los platos de la tabla, sin filtrar por usuario
  const { data: menu, error } = await supabase.from('Menu').select('*').order('id')
  if (error) return console.error(error)

  cartaUl.innerHTML = ''
  menu.forEach(item => {
    const li = document.createElement('li')
    li.innerHTML = `
      <div class="left">
        <span class="dish">${item.plato}</span>
        ${item.descripcion ? `<span class="descripcion">${item.descripcion}</span>` : ''}
      </div>
      ${item.precio ? `<span class="precio">‚Ç¨${item.precio}</span>` : ''}
    `
    cartaUl.appendChild(li)
  })
}

// Collapsible
document.querySelectorAll(".collapsible").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".collapsible").forEach(otherBtn => {
      if (otherBtn !== btn) {
        otherBtn.classList.remove("active")
        otherBtn.nextElementSibling.style.display = "none"
      }
    })
    btn.classList.toggle("active")
    const content = btn.nextElementSibling
    content.style.display = content.style.display === "block" ? "none" : "block"
  })
})

cargarCarta()
</script>

</body>
</html>
